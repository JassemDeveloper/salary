<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Salary Quarter Checker</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">
<div class="container py-5">
  <div class="row justify-content-center">
    <div class="col-lg-8">
      <div class="card shadow-sm">
        <div class="card-body p-4">
          <h1 class="h4 mb-3">Salary Quarter Checker</h1>

          <div class="row g-3 align-items-end">
            <div class="col-md-4">
              <label class="form-label">Grade (GC)</label>
              <select id="grade" class="form-select">
                <option value="" selected disabled>Select grade</option>
                <option>6</option><option>7</option><option>8</option>
                <option>9</option><option>10</option><option>11</option>
                <option>12</option><option>13</option><option>14</option>
                <option>15</option><option>16</option><option>17</option>
              </select>
            </div>

            <div class="col-md-5">
              <label class="form-label">Salary</label>
              <input id="salary" type="number" class="form-control" placeholder="e.g., 25000" min="0" step="1">
            </div>

            <div class="col-md-3 d-grid">
              <button id="checkBtn" class="btn btn-primary">Check</button>
            </div>
          </div>

          <hr class="my-4">
          <div id="result" class="alert d-none"></div>

          <button class="btn btn-outline-secondary btn-sm mt-3"
                  data-bs-toggle="collapse"
                  data-bs-target="#salaryTable">
            Show Salary Table
          </button>

          <div id="salaryTable" class="collapse mt-3">
            <div class="table-responsive">
              <table class="table table-sm table-striped align-middle">
                <thead class="table-dark">
                  <tr>
                    <th>GC</th>
                    <th>0‚Äì25%</th>
                    <th>25‚Äì50%</th>
                    <th>50‚Äì75%</th>
                    <th>75‚Äì100%</th>
                  </tr>
                </thead>
                <tbody id="salaryTableBody"></tbody>
              </table>
            </div>
          </div>

        </div>
      </div>
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

<script>
const salaryBands = {
  6:{min:6695,max:12700,quarters:[{name:"1st Quarter",min:6695,max:8196},{name:"2nd Quarter",min:8197,max:9698},{name:"3rd Quarter",min:9699,max:11199},{name:"4th Quarter",min:11200,max:12700}]},
  7:{min:7695,max:14615,quarters:[{name:"1st Quarter",min:7695,max:9425},{name:"2nd Quarter",min:9426,max:11155},{name:"3rd Quarter",min:11156,max:12885},{name:"4th Quarter",min:12886,max:14615}]},
  8:{min:8850,max:16810,quarters:[{name:"1st Quarter",min:8850,max:10840},{name:"2nd Quarter",min:10841,max:12830},{name:"3rd Quarter",min:12831,max:14820},{name:"4th Quarter",min:14821,max:16810}]},
  9:{min:10175,max:19330,quarters:[{name:"1st Quarter",min:10175,max:12464},{name:"2nd Quarter",min:12465,max:14753},{name:"3rd Quarter",min:14754,max:17041},{name:"4th Quarter",min:17042,max:19330}]},
  10:{min:11700,max:22235,quarters:[{name:"1st Quarter",min:11700,max:14334},{name:"2nd Quarter",min:14335,max:16968},{name:"3rd Quarter",min:16969,max:19601},{name:"4th Quarter",min:19602,max:22235}]},
  11:{min:13525,max:29310,quarters:[{name:"1st Quarter",min:13525,max:17471},{name:"2nd Quarter",min:17472,max:21418},{name:"3rd Quarter",min:21419,max:25364},{name:"4th Quarter",min:25365,max:29310}]},
  12:{min:16230,max:33445,quarters:[{name:"1st Quarter",min:16230,max:20534},{name:"2nd Quarter",min:20535,max:24838},{name:"3rd Quarter",min:24839,max:29141},{name:"4th Quarter",min:29142,max:33445}]},
  13:{min:18835,max:38800,quarters:[{name:"1st Quarter",min:18835,max:23826},{name:"2nd Quarter",min:23827,max:28818},{name:"3rd Quarter",min:28819,max:33809},{name:"4th Quarter",min:33810,max:38800}]},
  14:{min:23740,max:48895,quarters:[{name:"1st Quarter",min:23740,max:30029},{name:"2nd Quarter",min:30030,max:36318},{name:"3rd Quarter",min:36319,max:42606},{name:"4th Quarter",min:42607,max:48895}]},
  15:{min:29665,max:61140,quarters:[{name:"1st Quarter",min:29665,max:37534},{name:"2nd Quarter",min:37535,max:45403},{name:"3rd Quarter",min:45404,max:53271},{name:"4th Quarter",min:53272,max:61140}]},
  16:{min:37780,max:77855,quarters:[{name:"1st Quarter",min:37780,max:47799},{name:"2nd Quarter",min:47800,max:57818},{name:"3rd Quarter",min:57819,max:67836},{name:"4th Quarter",min:67837,max:77855}]},
  17:{min:42405,max:87385,quarters:[{name:"1st Quarter",min:42405,max:53650},{name:"2nd Quarter",min:53651,max:64895},{name:"3rd Quarter",min:64896,max:76140},{name:"4th Quarter",min:76141,max:87385}]}
};

const fmt=n=>n.toLocaleString("en-US");

// Render salary table
Object.keys(salaryBands).sort((a,b)=>+a-+b).forEach(gc=>{
  const q=salaryBands[gc].quarters;
  document.getElementById("salaryTableBody").innerHTML += `
    <tr>
      <td>${gc}</td>
      <td>${fmt(q[0].min)} ‚Äì ${fmt(q[0].max)}</td>
      <td>${fmt(q[1].min)} ‚Äì ${fmt(q[1].max)}</td>
      <td>${fmt(q[2].min)} ‚Äì ${fmt(q[2].max)}</td>
      <td>${fmt(q[3].min)} ‚Äì ${fmt(q[3].max)}</td>
    </tr>
  `;
});

function badge(text,type){
  return `<span class="badge bg-${type} me-1 mb-1">${text}</span>`;
}

function show(type, html){
  const r=document.getElementById("result");
  r.className = `alert alert-${type}`;
  r.innerHTML = html;
  r.classList.remove("d-none");
}

document.getElementById("checkBtn").onclick=()=>{
  const grade = document.getElementById("grade").value;
  const enteredSalary = Number(document.getElementById("salary").value);

  if(!grade || !Number.isFinite(enteredSalary) || enteredSalary <= 0){
    return show("warning", "Enter a valid salary and select a grade.");
  }

  const band = salaryBands[grade];
  if (enteredSalary < band.min){
    return show("danger", `Salary <strong>${fmt(enteredSalary)}</strong> is below grade minimum <strong>${fmt(band.min)}</strong>.`);
  }

  // ‚úÖ Cap at max if exceeded
  const capped = enteredSalary > band.max;
  const salary = capped ? band.max : enteredSalary;

  const idx = band.quarters.findIndex(q => salary >= q.min && salary <= q.max);
  const current = band.quarters[idx];

  const passed = band.quarters.slice(0, idx).map(q => badge(q.name, "success")).join("") || badge("None", "secondary");
  const currentBadge = badge(current.name + " (Current)", "primary");
  const upcoming = band.quarters.slice(idx+1).map(q => badge(q.name, "secondary")).join("") || badge("None ‚Äî Max reached", "dark");

  // Increase from min
  const increaseFromMin = salary - band.min;

  // ‚úÖ Percent from min should be 100% when salary == max (or exceeded -> capped to max)
  const percentFromMin = (salary >= band.max)
    ? 100
    : ((increaseFromMin / (band.max - band.min)) * 100);

  // Increase needed to max
  const neededToMax = band.max - salary;
  const percentToMax = (salary >= band.max)
    ? 0
    : ((neededToMax / (band.max - band.min)) * 100);

  show("success", `
    ${capped ? `<div class="mb-2 text-warning"><strong>Note:</strong> Entered salary exceeds the grade maximum. Calculations use the maximum (${fmt(band.max)}).</div>` : ""}

    <strong>Quarter Progression</strong><br><br>

    <strong>‚úî Quarters Passed:</strong><br>${passed}<br><br>
    <strong>üìç Current Quarter:</strong><br>${currentBadge}<br><br>
    <strong>üéØ Not Reached Yet:</strong><br>${upcoming}<br><br>

    <hr class="my-2">

    <strong>Increase from Min:</strong> ${fmt(increaseFromMin)} 
    (<strong>${percentFromMin.toFixed(2)}%</strong> of the grade range)<br>

    <strong>Increase Needed to Reach Max:</strong> ${fmt(neededToMax)} 
    (<strong>${percentToMax.toFixed(2)}%</strong> of the grade range)
  `);
};
</script>
</body>
</html>
